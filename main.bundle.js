!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t){t.exports=JSON.parse('{"0":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,0,0,0,1,0,0,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,0,0,1,0,0,0,1,1,1,0,0]},"1":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1,1,1,1]},"2":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,0,0,0,0,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,1,1,1,1]},"3":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"4":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,0,1,1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,0,1,1,0,0,1,1,0,1,1,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0]},"5":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,0,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"6":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,1,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"7":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0]},"8":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,0,0,1,1,0,0,0,1,0,1,1,1,0,0,1,0,0,1,1,1,1,0,0,1,0,0,0,0,1,1,1,0,0,0,0,1,1,0,1,1,1,1,1,0]},"9":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,0,0]}," ":{"offsetX":-2,"offsetY":0,"width":7,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},".":{"offsetX":0,"offsetY":0,"width":2,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,1,1,1,1]},":":{"offsetX":0,"offsetY":0,"width":2,"height":7,"tile":[0,0,1,1,1,1,0,0,0,0,1,1,1,1]},";":{"offsetX":0,"offsetY":2,"width":2,"height":7,"tile":[1,1,1,1,0,0,0,0,1,1,0,1,1,0]},"\'":{"offsetX":0,"offsetY":0,"width":2,"height":7,"tile":[1,1,1,1,0,1,0,0,0,0,0,0,0,0]},"\\"":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[1,1,0,1,1,1,1,0,1,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},",":{"offsetX":0,"offsetY":2,"width":2,"height":7,"tile":[0,0,0,0,0,0,0,0,1,1,0,1,1,0]},"!":{"offsetX":1,"offsetY":0,"width":2,"height":7,"tile":[1,1,1,1,1,1,1,1,1,1,0,0,1,1]},"?":{"offsetX":0,"offsetY":0,"width":6,"height":7,"tile":[0,1,1,1,1,0,1,1,0,0,1,1,1,1,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0]},"_":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1]},"-":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"+":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,1,1,1,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0]},"=":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0]},"*":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[1,0,1,0,1,0,1,1,1,0,1,1,1,1,1,0,1,1,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0]},"(":{"offsetX":0,"offsetY":-1,"width":3,"height":9,"tile":[0,1,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,0,1,1]},")":{"offsetX":0,"offsetY":-1,"width":3,"height":9,"tile":[1,1,0,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,1,0]},"/":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0]},"A":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,0,0,0,1,1,0,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1]},"B":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,0]},"C":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,0]},"D":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,0,0,1,1,0,0,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,0,0]},"E":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1,1]},"F":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0]},"G":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,1,1,0,0,1,1,1,1,1,0,0,0,1,1,0,1,1,0,0,1,1,0,0,1,1,1,1,1]},"H":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1]},"I":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1,1,1,1]},"J":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,0,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"K":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,0,1,1,0,0,1,1,1,1,0,0,0,1,1,1,1,1,0,0,1,1,0,1,1,1,0,1,1,0,0,1,1,1]},"L":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1]},"M":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1]},"N":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,1,1]},"O":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"P":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0]},"Q":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,0,1]},"R":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,0,0,1,1,0,1,1,1,0,1,1,0,0,1,1,1]},"S":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"T":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0]},"U":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"V":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0]},"W":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,1,1]},"X":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,1]},"Y":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,0,0,1,1,0,1,1,0,0,1,1,0,1,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0]},"Z":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1,1,1,1,1]}}')},function(t,e,i){"use strict";i.r(e);var n=function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var o,s,a,r,l,c,h=!1,f=0;function g(){h&&(requestAnimationFrame(g),a=Date.now(),(s=a-o)>24&&(o=a-s%24,l.debug.onTick&&console.log(f),r(),f++))}function u(){return{items:[],addItems:function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.items.find((function(e){return e.name===t}));n||(n={name:t,items:[]},this.items.push(n));for(var o=0,s=e;o<s.length;o++){var a=s[o];n.items.push(a)}},draw:function(t,e){this.items.forEach((function(i){i.items.forEach((function(i){i.sprite.draw(t,e,c)}))}))},empty:function(){this.items=[]},getItem:function(t){for(var e,i=0,n=this.items;i<n.length;i++){for(var o=0,s=n[i].items;o<s.length;o++){var a=s[o];if(a.name===t){e=a.sprite;break}}if(e)break}return e},getGroup:function(t){return this.items.find((function(e){return e.name===t}))},removeGroup:function(t){for(var e=0;e<this.items.length;e++)if(this.items[e].name===t){this.items.splice(e,1);break}},removeItem:function(t,e){for(var i=0,n=this.items;i<n.length;i++){var o=n[i];if(o.name===t){for(var s=0;s<o.items.length;s++)if(o.items[s].name===e){o.items.splice(s,1);break}break}}}}}function d(t,e){var i=Object.keys(t).length,n={},o=0;i||e({});var s=function(s){var a=new XMLHttpRequest;a.onload=function(){if(!(a.status>=200&&a.status<300))throw console.error(a.responseText),new Error('Tile "'+s+'" was not found');n[s]=JSON.parse(a.responseText),++o===i&&e(n)},a.open("GET",t[s]),a.send()};for(var a in t)s(a)}function p(t,e){var i={};for(var n in t){var o=t[n];o.endsWith(e)&&(i[n]=o)}return i}function m(t,e,i){function n(t){i(t)}t.load(p(e,".mp3"),(function(){d(p(e,".json"),n)}))}var v=function(){},y=[],w={upPress:v,leftPress:v,downPress:v,rightPress:v,aPress:v,bPress:v,selectPress:v,startPress:v,upRelease:v,leftRelease:v,downRelease:v,rightRelease:v,aRelease:v,bRelease:v,selectRelease:v,startRelease:v,keyDown:v,keyUp:v,reset:function(){w.upPress=v,w.leftPress=v,w.downPress=v,w.rightPress=v,w.aPress=v,w.bPress=v,w.selectPress=v,w.startPress=v,w.upRelease=v,w.leftRelease=v,w.downRelease=v,w.rightRelease=v,w.aRelease=v,w.bRelease=v,w.selectRelease=v,w.startRelease=v,w.keyDown=v,w.keyUp=v},update:function(){for(var t=0,e=y;t<e.length;t++){var i=e[t];w[i]()}y=[]}};document.onkeydown=function(t){switch(t.preventDefault(),t.key){case"w":case"W":case"ArrowUp":y.push("upPress");break;case"d":case"D":case"ArrowRight":y.push("rightPress");break;case"s":case"S":case"ArrowDown":y.push("downPress");break;case"a":case"A":case"ArrowLeft":y.push("leftPress");break;case"j":case"J":case"z":case"Z":y.push("aPress");break;case"k":case"K":case"x":case"X":y.push("bPress");break;case" ":y.push("selectPress");break;case"Enter":y.push("startPress")}t.metaKey||y.push("keyDown")},document.onkeyup=function(t){switch(t.preventDefault(),t.key){case"w":case"W":case"ArrowUp":y.push("upRelease");break;case"d":case"D":case"ArrowRight":y.push("rightRelease");break;case"s":case"S":case"ArrowDown":y.push("downRelease");break;case"a":case"A":case"ArrowLeft":y.push("leftRelease");break;case"j":case"J":case"z":case"Z":y.push("aRelease");break;case"k":case"K":case"x":case"X":y.push("bRelease");break;case" ":y.push("selectRelease");break;case"Enter":y.push("startRelease")}t.metaKey||y.push("keyUp")};var b,P={tracks:{},load:function(t,e){var i=Object.keys(t).length,n=0;function o(){++n===i&&e()}for(var s in i||e(),t){var a=new Audio;this.tracks[s]=a,a.src=t[s],a.oncanplaythrough=o}},play:function(t,e,i){var n=this;void 0===e&&(e=!1),i&&(this.tracks[t].onended=function(){i(),n.tracks[t].onended=null}),this.tracks[t].loop=e,this.tracks[t].play()},pause:function(t){this.tracks[t].pause()},pauseAll:function(){for(var t in this.tracks)this.tracks[t].pause()}},x=function(){return(x=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},k=function(t,e){for(var i=0,n=e.length,o=t.length;i<n;i++,o++)t[o]=e[i];return t},A={},S=!1,T={count:0,ticks:0,callback:function(){},init:function(t,e){this.count=0,this.ticks=t,this.callback=e},update:function(){this.count++,this.count===this.ticks&&this.callback()}};function I(t){t.canvas.clear("static",t.bgColor),t.staticPool.draw("static",t.canvas)}function X(t){t.canvas.clear("dynamic"),t.dynamicPool.draw("dynamic",t.canvas)}function Y(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];b.data=t,b.init.apply(b,e),I(b),b.redrawStaticItems=function(){return I(b)},b.canvas.onResize=function(){"function"==typeof b.onResize&&b.onResize(),I(b)},S=!1}function R(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!A[t])throw new Error('scene "'+t+'" does not exist');S=!0,b&&(b.data={},b.other={},b.staticPool.empty(),b.dynamicPool.empty(),b.controls.reset(),"function"==typeof b.destroy&&b.destroy()),(b=A[t]).changeScene=R,b.preload&&Object.keys(b.preload).length?(b.config.debug&&console.log("waiting for "+t+" preload..."),m(b.mediaPlayer,b.preload,(function(i){Y.apply(void 0,k([i],e)),b.config.debug&&console.log("loaded scene: "+t)}))):(Y.apply(void 0,k([{}],e)),b.config.debug&&console.log("loaded scene: "+t))}var E=function(){return(E=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function O(t){return void 0===t&&(t={}),E({x:0,y:0,width:0,height:0,centerX:function(t){var e=t.x+t.width/2;this.x=Math.floor(e-this.width/2)},centerY:function(t){var e=t.y+t.height/2;this.y=Math.floor(e-this.height/2)},getBottom:function(){return this.y+this.height},getRight:function(){return this.x+this.width},getCenterX:function(){return this.x+this.width/2},getCenterY:function(){return this.y+this.height/2}},t)}var j=function(){return(j=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function C(t){return void 0===t&&(t={}),j({color:"#065",rectangle:t.rectangle,offsetX:0,offsetY:0,block:function(t){var e=this.getOverlap(t);Math.abs(e.x)<Math.abs(e.y)?t.rectangle.x-=e.x:t.rectangle.y-=e.y},draw:function(t,e){var i=e.config.ppp;e.context[t].globalAlpha=.4,e.context[t].fillStyle=this.color,e.context[t].fillRect(this.getX()*i,this.getY()*i,this.getWidth()*i,this.getHeight()*i)},getOverlap:function(t){if(!this.hasOverlap(t))return{x:0,y:0};var e=Math.max(this.getX(),t.getX()),i=Math.max(this.getY(),t.getY()),n=Math.min(this.getX()+this.getWidth(),t.getX()+t.getWidth())-e,o=Math.min(this.getY()+this.getHeight(),t.getY()+t.getHeight())-i;return{x:this.getX()<t.getX()?-n:n,y:this.getY()<t.getY()?-o:o}},getX:function(){return this.rectangle.x+this.offsetX},getY:function(){return this.rectangle.y+this.offsetY},getWidth:function(){return this.rectangle.width-2*this.offsetX},getHeight:function(){return this.rectangle.height-2*this.offsetY},getBottom:function(){return this.getY()+this.getHeight()},getRight:function(){return this.getX()+this.getWidth()},hasOverlap:function(t){return this.getX()<t.getRight()&&this.rectangle.getRight()>t.getX()&&this.getY()<t.getBottom()&&this.rectangle.getBottom()>t.getY()}},t)}var W=function(){return(W=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function N(t,e,i,n,o){var s=0,a=0,r=e.config.ppp,l=o.tiles[o.frame];e.context[t].globalAlpha=1;for(var c=0;c<l.length;c++){var h=l[c];h&&(e.context[t].fillStyle=h,e.context[t].fillRect((i+s)*r,(n+a)*r,r,r)),s===o.width-1?(s=0,a++):s++}}function D(t){void 0===t&&(t={});var e=void 0===t.isInteractive||t.isInteractive,i=O({width:t.metaTile.width,height:t.metaTile.height}),n=e?C({rectangle:i}):null;var o={};return W({hitBox:n,metaTile:null,playingAnimation:null,rectangle:i,visible:!0,draw:function(t,i,s){this.visible&&(!function(t,i,o){o.debug.hitBox&&e&&n.draw(t,i)}(t,i,s),s.debug.onTick&&console.log("MetaTileSprite.draw()"+(this.playingAnimation?" animation("+this.playingAnimation+")":"")),this.playingAnimation?o[this.playingAnimation].draw(t,i):N(t,i,this.rectangle.x,this.rectangle.y,this.metaTile))},addAnimation:function(t,e,i,n,s){var a=this,r=!0,l=!1,c=e,h=0;o[t]={start:function(){r=!0},stop:function(t){t&&(c=t>0?t:i),r=!1},draw:function(t,o){h<n?h++:(r&&(c=Math.min(i,++c)),l&&("loop"===s?c=e:"function"==typeof s&&s(),l=!1),h=0),r&&c===i&&(l=!0),a.metaTile.frame=c,N(t,o,a.rectangle.x,a.rectangle.y,a.metaTile)}}},startAnimation:function(t){this.stopAnimation(),o[t].start(),this.playingAnimation=t},stopAnimation:function(){this.playingAnimation&&(o[this.playingAnimation].stop(),this.playingAnimation=null)}},t)}var H=function(){return(H=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function B(t,e){if(t[e])return!0;throw new Error('Font does not contain the character "'+e+'"')}function M(t,e,i,n,o){for(var s=0,a=0,r=e.config.ppp,l=0;l<o.tile.length;l++)1===o.tile[l]&&e.context[t].fillRect((i+s+o.offsetX)*r,(n+a+o.offsetY)*r,r,r),s===o.width-1?(s=0,a++):s++}function L(t,e,i,n,o,s){for(var a=o.split(""),r=i,l=n,c=0;c<a.length;c++){var h=a[c];B(s.font,h)&&(M(t,e,r,l,s.font[h]),r+=s.font[h].width),r+=s.tracking}}function F(t,e,i){for(var n=[],o=t.split(" "),s=e.font[" "],a=s.width+s.offsetX+e.tracking,r="",l=0,c=0;c<o.length;c++){for(var h=o[c],f=0,g=0,u=h.split("");g<u.length;g++){var d=u[g];if(B(e.font,d)){var p=e.font[d];f+=p.width+p.offsetX+e.tracking}}(l+=f+=a)<=i?r+=h+" ":(""!==r&&n.push(r),r=h+" ",l=f)}return n.push(r.trimEnd()),n}function G(t){void 0===t&&(t={});var e=O({width:t.maxWidth||function(t,e){for(var i=0,n=0,o=t.split("");n<o.length;n++){var s=o[n];if(B(e.font,s)){var a=e.font[s];i+=a.width+a.offsetX+e.tracking}}return i}(t.value,t.options)}),i={};return H({color:"#c59",maxWidth:null,options:{font:null,tracking:0,lineHeight:0},playingAnimation:null,rectangle:e,value:"",visible:!0,draw:function(t,e,n){if(this.visible)if(e.context[t].fillStyle=this.color,n.debug.onTick&&console.log("TextSprite.draw()"+(this.playingAnimation?" animation("+this.playingAnimation+")":"")),this.playingAnimation)i[this.playingAnimation].draw(t,e);else if(this.maxWidth)for(var o=F(this.value,this.options,this.maxWidth),s=this.rectangle.y,a=0,r=o;a<r.length;a++){var l=r[a];L(t,e,this.rectangle.x,s,l,this.options),s+=this.options.lineHeight}else L(t,e,this.rectangle.x,this.rectangle.y,this.value,this.options)},addAnimation:function(t,e,n,o,s){var a=this,r=a.value.split("").length,l=0,c=e,h=!1,f=!0;n=n>0?n:r,i[t]={start:function(){f=!0},stop:function(t){t&&(c=t>0?t:r),f=!1},draw:function(t,i){if(a.visible)if(l<o?l++:(f&&(c=Math.min(n,++c)),h&&("loop"===s?c=e:"function"==typeof s&&s(),h=!1),l=0),f&&c===n&&(h=!0),a.maxWidth)for(var r=F(a.value,a.options,a.maxWidth),g=a.rectangle.y,u=0,d=0,p=r;d<p.length;d++){var m=p[d];if(!(u+m.length<c)){L(t,i,a.rectangle.x,g,m.slice(0,c-u),a.options),u+=c-u;break}L(t,i,a.rectangle.x,g,m,a.options),u+=m.length,g+=a.options.lineHeight}else L(t,i,a.rectangle.x,a.rectangle.y,a.value.slice(0,c),a.options)}}},startAnimation:function(t){this.stopAnimation(),i[t].start(),this.playingAnimation=t},stopAnimation:function(){this.playingAnimation&&(i[this.playingAnimation].stop(),this.playingAnimation=null)}},t)}var z={font:i(0),tracking:1,lineHeight:10},U={offsetX:7,offsetY:1,ticksPerBlink:16,tickCount:0,update:function(t,e){var i=t.dynamicPool.getItem("cursor");this.tickCount<this.ticksPerBlink?this.tickCount++:(i.visible=!i.visible,this.tickCount=0),i.rectangle.x=e.x-i.rectangle.width-this.offsetX,i.rectangle.y=e.y-this.offsetY}};function K(t){var e=t.config.titleSafe,i=O({width:t.canvas.config.width,height:t.canvas.config.height}),n=t.staticPool.getItem("title"),o=t.staticPool.getItem("about"),s=t.staticPool.getItem("about2"),a=t.staticPool.getItem("link"),r=t.staticPool.getItem("back");n.rectangle.centerX(i),n.rectangle.y=e,o.rectangle.x=e,o.rectangle.y=n.rectangle.y+2*z.lineHeight,s.rectangle.x=e,s.rectangle.y=o.rectangle.y+6*z.lineHeight,r.rectangle.centerX(i),r.rectangle.y=i.height-z.lineHeight-e,a.rectangle.centerX(i),a.rectangle.y=r.rectangle.y-2*z.lineHeight}var J,V={index:0},_={name:"about",bgColor:"#000",preload:{cursor:"src/scenes/assets/title/cursor.json"},init:function(){var t=this;V.index=0,U.tickCount=0,this.staticPool.addItems("main",{name:"title",sprite:G({color:"#eee",options:z,value:"ABOUT"})}),this.staticPool.addItems("main",{name:"about",sprite:G({color:"#eee",options:z,maxWidth:this.canvas.config.width-2*this.config.titleSafe,value:"THIS PROJECT IS AN ODE TO ONE OF MY FAVORITE PODCASTS: HELLO FROM THE MAGIC TAVERN. IT IS NOT AFFILIATED WITH THE SHOW IN ANY WAY. (NOT THAT I'M AGAINST THAT HAPPENING - JUST SAYING)"})}),this.staticPool.addItems("main",{name:"about2",sprite:G({color:"#eee",options:z,maxWidth:this.canvas.config.width-2*this.config.titleSafe,value:"I TAKE NO CREDIT FOR WHAT THE BRILLIANT, TWISTED MINDS OF THE ARTISTS HAVE CREATED; I AM MERELY EXPRESSING MY AFFECTION FOR SAID CREATION WITH A BIT OF 8BIT, JRPG-ESQUE FAN FIC."})}),this.staticPool.addItems("selection",{name:"link",sprite:G({color:"#eee",options:z,value:"SEE MORE..."})}),this.staticPool.addItems("selection",{name:"back",sprite:G({color:"#eee",options:z,value:"BACK TO TITLE SCREEN"})}),K(this),this.dynamicPool.addItems("main",{name:"cursor",sprite:D({metaTile:this.data.cursor})});var e=function(){switch(V.index){case 0:window.open("https://github.com/adventuresinfoon/adventuresinfoon.github.io/blob/main/README.md");break;case 1:t.changeScene("title")}},i=this.staticPool.getGroup("selection");this.controls.upPress=function(){V.index>0&&V.index--},this.controls.downPress=function(){V.index<i.items.length-1&&V.index++},this.controls.aPress=function(){e()},this.controls.startPress=function(){e()}},update:function(){var t=this.staticPool.getGroup("selection");U.update(this,t.items[V.index].sprite.rectangle)},onResize:function(){K(this)}};!function(t){t.South="South",t.West="West",t.North="North",t.East="East"}(J||(J={}));var q=function(){return(q=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function Z(t,e,i){var n=0,o=0;t.tiles.forEach((function(s,a){if(s>0){var r=t.legend[s],l=D(q({metaTile:e.data[r.dataKey]},r.params));l.rectangle.x=n*t.tileSize,l.rectangle.y=o*t.tileSize,i.addItems(t.name,{name:r.name||""+t.name+a,sprite:l})}n===t.width-1?(n=0,o++):n++}))}function Q(t,e){var i=0,n=0;e.other.walls=[],t.tiles.forEach((function(o){var s,a;o>0&&e.other.walls.push((s={x:i*t.tileSize,y:n*t.tileSize,width:t.tileSize,height:t.tileSize},{rectangle:a=O(s),hitBox:C({color:"#505",rectangle:a})})),i===t.width-1?(i=0,n++):i++}))}var $={name:"forestIntro",bgColor:"#840",preload:{arnie:"src/scenes/assets/prologue/arnie.json",camry:"src/scenes/assets/prologue/camry.json",portalSmall:"src/scenes/assets/prologue/portal-small.json",brush:"src/scenes/assets/prologue/forest-intro/brush.json",brushS:"src/scenes/assets/prologue/forest-intro/brush-S.json",brushW:"src/scenes/assets/prologue/forest-intro/brush-W.json",brushN:"src/scenes/assets/prologue/forest-intro/brush-N.json",brushE:"src/scenes/assets/prologue/forest-intro/brush-E.json",brushSW:"src/scenes/assets/prologue/forest-intro/brush-SW.json",brushNW:"src/scenes/assets/prologue/forest-intro/brush-NW.json",brushNE:"src/scenes/assets/prologue/forest-intro/brush-NE.json",brushSE:"src/scenes/assets/prologue/forest-intro/brush-SE.json",dialogue:"src/scenes/assets/prologue/forest-intro/dialogue.json",dirt:"src/scenes/assets/prologue/forest-intro/dirt.json",grid:"src/scenes/assets/prologue/forest-intro/grid.json",tree:"src/scenes/assets/prologue/forest-intro/tree.json"},init:function(t){var e,i,n=this;e=this.data.grid,i=this,e.dynamicLayers.forEach((function(t){Z(t,i,i.dynamicPool)})),e.staticLayers.forEach((function(t){Z(t,i,i.staticPool)})),Q(e.wallLayer,i);var o={x:192,y:112,facingDirection:J.South};t=t||o,this.other.arnie=function(t){var e,i,n=D({metaTile:t.data.arnie});t.dynamicPool.addItems("characters",{name:"arnie",sprite:n});var o=((e={})[J.South]=0,e[J.West]=4,e[J.North]=8,e[J.East]=12,e),s=((i={})[J.South]=!1,i[J.West]=!1,i[J.North]=!1,i[J.East]=!1,i);return n.addAnimation("walk:South",0,3,6,"loop"),n.addAnimation("walk:West",4,7,6,"loop"),n.addAnimation("walk:North",8,11,6,"loop"),n.addAnimation("walk:East",12,15,6,"loop"),n.hitBox.offsetX=2,n.hitBox.offsetY=2,{sprite:n,isWalking:!1,handleDirectionalPress:function(t){s[t]=!0,this.isWalking=!0,n.stopAnimation(),n.startAnimation("walk:"+t)},handleDirectionalRelease:function(t){s[t]=!1,n.stopAnimation(),s[J.South]&&n.startAnimation("walk:"+J.South),s[J.West]&&n.startAnimation("walk:"+J.West),s[J.North]&&n.startAnimation("walk:"+J.North),s[J.East]&&n.startAnimation("walk:"+J.East),s[J.South]||s[J.West]||s[J.North]||s[J.East]||(this.isWalking=!1,n.stopAnimation(),n.metaTile.frame=o[t])},setFacingDirection:function(t){n.metaTile.frame=o[t]},update:function(){this.isWalking&&(s[J.South]&&(n.rectangle.y+=1),s[J.West]&&(n.rectangle.x-=1),s[J.North]&&(n.rectangle.y-=1),s[J.East]&&(n.rectangle.x+=1))}}}(this),this.other.arnie.sprite.rectangle.x=t.x,this.other.arnie.sprite.rectangle.y=t.y,this.other.arnie.setFacingDirection(t.facingDirection),this.controls.downPress=function(){n.other.arnie.handleDirectionalPress(J.South)},this.controls.leftPress=function(){n.other.arnie.handleDirectionalPress(J.West)},this.controls.upPress=function(){n.other.arnie.handleDirectionalPress(J.North)},this.controls.rightPress=function(){n.other.arnie.handleDirectionalPress(J.East)},this.controls.downRelease=function(){n.other.arnie.handleDirectionalRelease(J.South)},this.controls.leftRelease=function(){n.other.arnie.handleDirectionalRelease(J.West)},this.controls.upRelease=function(){n.other.arnie.handleDirectionalRelease(J.North)},this.controls.rightRelease=function(){n.other.arnie.handleDirectionalRelease(J.East)}},update:function(t){var e=this;this.other.arnie.update(t),this.other.walls.forEach((function(i){i.hitBox.block(e.other.arnie.sprite.hitBox),e.config.debug.walls&&i.hitBox.draw("dynamic",t)}))}},tt=function(){return(tt=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function et(t){return void 0===t&&(t={}),tt({fill:null,opacity:1,rectangle:O(),strokeColor:null,strokeWidth:1,visible:!0,draw:function(t,e,i){this.visible&&(i.debug.onTick&&console.log("RectangleSprite.draw()"),function(t,e,i,n,o,s,a){var r=e.config.ppp,l=e.context[t],c=l.globalAlpha;l.globalAlpha=a,i&&(l.fillStyle=i,l.fillRect(s.x*r,s.y*r,s.width*r,s.height*r)),n&&(l.strokeStyle=n,l.lineWidth=o,l.strokeRect(s.x*r,s.y*r,s.width*r,s.height*r)),l.globalAlpha=c}(t,e,this.fill,this.strokeColor,this.strokeWidth,this.rectangle,this.opacity))}},t)}var it=0;function nt(t,e,i){var n=!1;it=0,function(t){var e=et({fill:"#000",rectangle:O({x:26,y:26,width:266,height:60})}),i=et({fill:"#eee",rectangle:O({x:26,y:24,width:266,height:2})}),n=et({fill:"#eee",rectangle:O({x:292,y:26,width:2,height:60})}),o=et({fill:"#eee",rectangle:O({x:26,y:86,width:266,height:2})}),s=et({fill:"#eee",rectangle:O({x:24,y:26,width:2,height:60})}),a=et({fill:"#eee",rectangle:O({x:25,y:25,width:2,height:2})}),r=et({fill:"#eee",rectangle:O({x:291,y:25,width:2,height:2})}),l=et({fill:"#eee",rectangle:O({x:291,y:85,width:2,height:2})}),c=et({fill:"#eee",rectangle:O({x:25,y:85,width:2,height:2})});t.dynamicPool.addItems("dialogue",{name:"bg",sprite:e},{name:"borderTop",sprite:i},{name:"borderRight",sprite:n},{name:"borderBottom",sprite:o},{name:"borderLeft",sprite:s},{name:"borderTopLeft",sprite:a},{name:"borderTopRight",sprite:r},{name:"borderBottomRight",sprite:l},{name:"borderBottomLeft",sprite:c})}(t);var o=G({color:"#eee",options:z,value:e[it].name+":"}),s=G({color:"#eee",maxWidth:254,options:z,value:e[it].dialogue});return o.rectangle.x=32,o.rectangle.y=32,s.rectangle.x=32,s.rectangle.y=32+z.lineHeight,s.addAnimation("advance",0,-1,t.config.textAdvanceSpeed,(function(){n=!0})),s.startAnimation("advance"),t.dynamicPool.addItems("dialogue",{name:"nameText",sprite:o},{name:"dialogueText",sprite:s}),{advance:function(){if(n){if(it===e.length-1)return t.dynamicPool.removeGroup("dialogue"),void("function"==typeof i&&i());it++,n=!1,o.value=e[it].name+":",s.value=e[it].dialogue,s.addAnimation("advance",0,-1,t.config.textAdvanceSpeed,(function(){n=!0})),s.startAnimation("advance")}else n=!0,s.stopAnimation()}}}function ot(t,e,i){var n=O({width:e.canvas.config.width,height:e.canvas.config.height}),o="in"===t?1:0,s=et({fill:"#000",rectangle:n});e.dynamicPool.addItems("transitions",{name:"rect",sprite:s});var a=function(){o-="in"===t?.26:-.26,s.opacity=o,"in"===t&&o<.1||"out"===t&&o>1?(e.dynamicPool.removeGroup("transitions"),i()):e.delay(8,a)};e.delay(8,a)}var st={name:"intro",bgColor:"#000",preload:{bg:"src/scenes/assets/intro/viscous-space.json",dialogue:"src/scenes/assets/intro/dialogue.json",static:"src/scenes/assets/intro/static.mp3",beepBoop:"src/scenes/assets/intro/beep-boop.mp3"},init:function(){var t=this;this.mediaPlayer.play("static",!1,(function(){t.mediaPlayer.play("beepBoop",!0),t.staticPool.addItems("bg",{name:"bg",sprite:D({metaTile:t.data.bg})}),t.redrawStaticItems(),ot("in",t,(function(){var e=nt(t,t.data.dialogue,(function(){t.mediaPlayer.pauseAll(),t.changeScene("parkingLotIntro")}));t.controls.aPress=function(){e.advance()}}))})),this.onResize=function(){return(e=t.staticPool.getItem("bg")).rectangle.x=0,void(e.rectangle.y=0);var e}}},at={name:"loading",bgColor:"#000",init:function(){var t=G({color:"#eee",options:z,value:"LOADING"});this.staticPool.addItems("main",{name:"main",sprite:t});var e=G({color:"#eee",options:z,value:"..."});e.addAnimation("cycle",0,null,16,"loop"),e.startAnimation("cycle"),this.dynamicPool.addItems("main",{name:"ellipsis",sprite:e});var i=this.canvas.config.height-(t.rectangle.height+16);t.rectangle.x=this.canvas.config.width-(t.rectangle.width+e.rectangle.width+8),t.rectangle.y=i,e.rectangle.x=t.rectangle.x+t.rectangle.width,e.rectangle.y=i}};var rt,lt,ct={portalShown:!1,portalSpedUp:!1,portalSuckingInCar:!1,portalConsumedCar:!1},ht={name:"parkingLotIntro",bgColor:"#444",preload:{camry:"src/scenes/assets/prologue/camry.json",dialogue:"src/scenes/assets/prologue/parking-lot-intro/dialogue.json",portalLarge:"src/scenes/assets/prologue/portal-large.json",portalSmall:"src/scenes/assets/prologue/portal-small.json",parkingLot:"src/scenes/assets/prologue/parking-lot-intro/parking-lot.json"},init:function(){var t=this;this.staticPool.addItems("main",{name:"smallPortal",sprite:D({metaTile:this.data.parkingLot})});var e=O({width:this.canvas.config.width,height:this.canvas.config.height}),i=D({metaTile:this.data.camry}),n=D({metaTile:this.data.portalSmall}),o=D({metaTile:this.data.portalLarge});lt=[this.data.dialogue.slice(0,3),this.data.dialogue.slice(3,4),this.data.dialogue.slice(4,5)],i.rectangle.centerX(e),i.rectangle.x-=40,i.rectangle.y=e.height/2-4,o.visible=!1,n.visible=!1,this.dynamicPool.addItems("main",{name:"smallPortal",sprite:n},{name:"largePortal",sprite:o},{name:"camry",sprite:i}),ot("in",this,(function(){rt=nt(t,lt[0],(function(){ct.portalShown||(ct.portalShown=!0,function(t,e,i,n){t.visible=!0,t.rectangle.x=i.canvas.config.width/2+32,t.rectangle.y=i.canvas.config.height/2+8,t.addAnimation("pulse",0,3,4,(function(){e.visible=!0,t.visible=!1,e.rectangle.x=i.canvas.config.width/2+24,e.rectangle.y=i.canvas.config.height/2,e.addAnimation("pulse",0,3,4,"loop"),e.startAnimation("pulse"),i.delay(24,n)})),t.startAnimation("pulse")}(n,o,t,(function(){rt=nt(t,lt[1],(function(){ct.portalSpedUp||(ct.portalSpedUp=!0,function(t){t.stopAnimation(),t.addAnimation("pulse",0,3,2,"loop"),t.startAnimation("pulse")}(o),t.delay(24,(function(){ct.portalSuckingInCar=!0})))}))})))})),t.controls.aPress=function(){rt.advance()}}))},update:function(){var t=this;if(ct.portalSuckingInCar){var e=this.dynamicPool.getItem("camry");if(e.rectangle.x+=1,e.rectangle.x>156){ct.portalSuckingInCar=!1,ct.portalConsumedCar=!0;var i=et({fill:"#eee"});i.rectangle.width=this.canvas.config.width,i.rectangle.height=this.canvas.config.height,this.dynamicPool.addItems("main",{name:"flash",sprite:i}),rt=nt(this,lt[2],(function(){t.changeScene("forestIntro")}))}}}};function ft(t){var e=O({width:t.canvas.config.width,height:t.canvas.config.height}),i=t.staticPool.getItem("controls"),n=t.dynamicPool.getItem("anyKey");i.rectangle.centerX(e),i.rectangle.y=18,n.rectangle.centerX(e),n.rectangle.y=e.height-2*z.lineHeight-t.config.titleSafe}var gt={ticksPerBlink:16,tickCount:0,update:function(t){var e=t.dynamicPool.getItem("anyKey");this.tickCount<this.ticksPerBlink?this.tickCount++:(e.visible=!e.visible,this.tickCount=0)}},ut={name:"splash",bgColor:"#000",preload:{controls:"src/scenes/assets/splash/controls.json"},init:function(){var t=this;gt.tickCount=0,this.controls.keyDown=function(){t.changeScene("title")},this.staticPool.addItems("main",{name:"controls",sprite:D({metaTile:this.data.controls})}),this.dynamicPool.addItems("main",{name:"anyKey",sprite:G({color:"#eee",options:z,value:"PRESS ANY BUTTON TO CONTINUE"})}),ft(this)},update:function(){gt.update(this)},onResize:function(){ft(this)}};function dt(t){var e=O({width:t.canvas.config.width,height:t.canvas.config.height}),i=t.staticPool.getItem("titleText"),n=t.staticPool.getItem("startGame"),o=t.staticPool.getItem("about"),s=t.staticPool.getItem("copyright");i.rectangle.centerX(e),n.rectangle.centerX(e),o.rectangle.centerX(e),s.rectangle.centerX(e),i.rectangle.y=18,n.rectangle.y=154,o.rectangle.y=n.rectangle.y+2*z.lineHeight,s.rectangle.y=e.height-z.lineHeight-t.config.titleSafe}var pt={index:0},mt={name:"title",bgColor:"#000",preload:{theme:"src/scenes/assets/title/theme.mp3",select:"src/scenes/assets/title/select.mp3",titleText:"src/scenes/assets/title/title-text.json",cursor:"src/scenes/assets/title/cursor.json"},init:function(){var t=this;pt.index=0,U.tickCount=0,this.staticPool.addItems("main",{name:"titleText",sprite:D({metaTile:this.data.titleText})}),this.staticPool.addItems("main",{name:"copyright",sprite:G({color:"#eee",options:z,value:"2021 COSMIC POLYGON"})}),this.staticPool.addItems("selection",{name:"startGame",sprite:G({color:"#eee",options:z,value:"START GAME"})}),this.staticPool.addItems("selection",{name:"about",sprite:G({color:"#eee",options:z,value:"ABOUT"})}),dt(this),this.dynamicPool.addItems("main",{name:"cursor",sprite:D({metaTile:this.data.cursor})});var e=function(){switch(P.pauseAll(),P.play("select"),pt.index){case 0:t.changeScene("intro");break;case 1:t.changeScene("about")}},i=this.staticPool.getGroup("selection");this.controls.upPress=function(){pt.index>0&&pt.index--},this.controls.downPress=function(){pt.index<i.items.length-1&&pt.index++},this.controls.aPress=function(){e()},this.controls.startPress=function(){e()},P.play("theme",!0)},update:function(){var t=this.staticPool.getGroup("selection");U.update(this,t.items[pt.index].sprite.rectangle)},onResize:function(){dt(this)}},vt={debug:{browser:!0,onTick:!1,hitBox:!1,walls:!1},textAdvanceSpeed:2,titleSafe:12},yt=function(t){void 0===t&&(t={});var e=n({ppp:1,width:320,height:240},t);function i(t){var i=document.createElement("canvas");i.id=t,i.width=e.width,i.height=e.height,i.style.position="absolute";var n=i.getContext("2d");return n.imageSmoothingEnabled=!1,{element:i,context:n}}var o=i("static"),s=i("dynamic");return document.body.style.margin="0",document.body.style.backgroundColor="#000",document.body.appendChild(o.element),document.body.appendChild(s.element),{element:{static:o.element,dynamic:s.element},context:{static:o.context,dynamic:s.context},config:e,onResize:null,clear:function(t,e){var i=this.config.width,n=this.config.height,o=this.config.ppp;e?(this.context[t].fillStyle=e,this.context[t].fillRect(0,0,i*o,n*o)):this.context[t].clearRect(0,0,i*o,n*o)},getScaleFactor:function(t,e){var i,n=t>e,o=this.config.width>this.config.height;return(i=n?o&&this.config.height*(t/this.config.width)<=e?t/this.config.width:e/this.config.height:!o&&this.config.width*(e/this.config.height)<=t?e/this.config.height:t/this.config.width)<2?i:Math.floor(i)},fitToViewport:function(){var t=window.innerWidth,e=window.innerHeight,i=this.getScaleFactor(t,e);for(var n in this.config.ppp=i,this.element){var o=this.element[n];o.width=this.config.width*i,o.height=this.config.height*i,o.style.top=e/2-o.height/2+"px",o.style.left=t/2-o.width/2+"px"}"function"==typeof this.onResize&&this.onResize()},requestFullscreen:function(){document.documentElement.requestFullscreen()}}}();yt.fitToViewport(),window.onresize=function(){return yt.fitToViewport()},window.ondeviceorientation=function(){return yt.fitToViewport()},vt.debug.browser||(window.onbeforeunload=function(){return!0}),c={config:vt}.config,function(t,e,i,n){for(var o,s=[],a=4;a<arguments.length;a++)s[a-4]=arguments[a];for(var r in t){var l=t[r];l=x(x({},l),{canvas:i,config:n,controls:w,delay:T.init.bind(T),dynamicPool:u(),data:{},mediaPlayer:P,other:{},staticPool:u()}),A[r]=l}A.loading&&(o=A.loading).init.apply(o,s),R.apply(void 0,k([e],s))}({loading:at,splash:ut,title:mt,about:_,intro:st,parkingLotIntro:ht,forestIntro:$},"splash",yt,vt),function(t){l=t.config,r=t.cb,o=Date.now(),h=!0,g()}({cb:function(){var t;t=yt,S?(I(A.loading),X(A.loading)):(X(b),"function"==typeof b.update&&b.update(t),T.update(),b.controls.update())},config:vt})}]);