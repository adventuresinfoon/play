!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t){t.exports=JSON.parse('{"0":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,0,0,0,1,0,0,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,0,0,1,0,0,0,1,1,1,0,0]},"1":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1,1,1,1]},"2":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,0,0,0,0,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,1,1,1,1]},"3":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"4":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,0,1,1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,0,1,1,0,0,1,1,0,1,1,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0]},"5":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,0,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"6":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,1,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"7":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0]},"8":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,0,0,1,1,0,0,0,1,0,1,1,1,0,0,1,0,0,1,1,1,1,0,0,1,0,0,0,0,1,1,1,0,0,0,0,1,1,0,1,1,1,1,1,0]},"9":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,1,1,1,1,0,0]}," ":{"offsetX":-2,"offsetY":0,"width":7,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},".":{"offsetX":0,"offsetY":0,"width":2,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,1,1,1,1]},":":{"offsetX":0,"offsetY":0,"width":2,"height":7,"tile":[0,0,1,1,1,1,0,0,0,0,1,1,1,1]},";":{"offsetX":0,"offsetY":2,"width":2,"height":7,"tile":[1,1,1,1,0,0,0,0,1,1,0,1,1,0]},"\'":{"offsetX":0,"offsetY":0,"width":2,"height":7,"tile":[1,1,1,1,0,1,0,0,0,0,0,0,0,0]},"\\"":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[1,1,0,1,1,1,1,0,1,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},",":{"offsetX":0,"offsetY":2,"width":2,"height":7,"tile":[0,0,0,0,0,0,0,0,1,1,0,1,1,0]},"!":{"offsetX":1,"offsetY":0,"width":2,"height":7,"tile":[1,1,1,1,1,1,1,1,1,1,0,0,1,1]},"?":{"offsetX":0,"offsetY":0,"width":6,"height":7,"tile":[0,1,1,1,1,0,1,1,0,0,1,1,1,1,0,0,1,1,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0]},"_":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1]},"-":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"+":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,1,1,1,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0]},"=":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0]},"*":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[1,0,1,0,1,0,1,1,1,0,1,1,1,1,1,0,1,1,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0]},"(":{"offsetX":0,"offsetY":-1,"width":3,"height":9,"tile":[0,1,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,0,1,1]},")":{"offsetX":0,"offsetY":-1,"width":3,"height":9,"tile":[1,1,0,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,1,0]},"/":{"offsetX":0,"offsetY":0,"width":5,"height":7,"tile":[0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0]},"A":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,0,0,0,1,1,0,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1]},"B":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,0]},"C":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,0]},"D":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,0,0,1,1,0,0,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,0,0]},"E":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1,1]},"F":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0]},"G":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,1,1,1,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,1,1,0,0,1,1,1,1,1,0,0,0,1,1,0,1,1,0,0,1,1,0,0,1,1,1,1,1]},"H":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1]},"I":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1,1,1,1]},"J":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,0,0,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"K":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,0,1,1,0,0,1,1,1,1,0,0,0,1,1,1,1,1,0,0,1,1,0,1,1,1,0,1,1,0,0,1,1,1]},"L":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,1]},"M":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1]},"N":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,1,1]},"O":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"P":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0]},"Q":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,0,1]},"R":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,0,0,1,1,0,1,1,1,0,1,1,0,0,1,1,1]},"S":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,0,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"T":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0]},"U":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,1,0]},"V":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0]},"W":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,1,1]},"X":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,0,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0,0,1,1]},"Y":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[0,1,1,0,0,1,1,0,1,1,0,0,1,1,0,1,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0]},"Z":{"offsetX":0,"offsetY":0,"width":7,"height":7,"tile":[1,1,1,1,1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1,1,1,1,1]}}')},function(t,e,i){"use strict";i.r(e);var n=function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var o,s=function(){},a=[];var r={upPress:s,leftPress:s,downPress:s,rightPress:s,aPress:s,bPress:s,selectPress:s,startPress:s,upRelease:s,leftRelease:s,downRelease:s,rightRelease:s,aRelease:s,bRelease:s,selectRelease:s,startRelease:s,keyDown:s,keyUp:s,reset:function(){r.upPress=s,r.leftPress=s,r.downPress=s,r.rightPress=s,r.aPress=s,r.bPress=s,r.selectPress=s,r.startPress=s,r.upRelease=s,r.leftRelease=s,r.downRelease=s,r.rightRelease=s,r.aRelease=s,r.bRelease=s,r.selectRelease=s,r.startRelease=s,r.keyDown=s,r.keyUp=s},update:function(){for(var t=0,e=a;t<e.length;t++){var i=e[t];r[i]()}a=[]}};document.onkeydown=function(t){switch(o.debug.preventDefault&&t.preventDefault(),t.key){case"w":case"W":case"ArrowUp":a.push("upPress");break;case"d":case"D":case"ArrowRight":a.push("rightPress");break;case"s":case"S":case"ArrowDown":a.push("downPress");break;case"a":case"A":case"ArrowLeft":a.push("leftPress");break;case"j":case"J":case"z":case"Z":a.push("aPress");break;case"k":case"K":case"x":case"X":a.push("bPress");break;case" ":a.push("selectPress");break;case"Enter":a.push("startPress")}t.metaKey||a.push("keyDown")},document.onkeyup=function(t){switch(o.debug.preventDefault&&t.preventDefault(),t.key){case"w":case"W":case"ArrowUp":a.push("upRelease");break;case"d":case"D":case"ArrowRight":a.push("rightRelease");break;case"s":case"S":case"ArrowDown":a.push("downRelease");break;case"a":case"A":case"ArrowLeft":a.push("leftRelease");break;case"j":case"J":case"z":case"Z":a.push("aRelease");break;case"k":case"K":case"x":case"X":a.push("bRelease");break;case" ":a.push("selectRelease");break;case"Enter":a.push("startRelease")}t.metaKey||a.push("keyUp")};var l,c,h,f,g,u,d=!1,p=0;function m(){d&&(requestAnimationFrame(m),h=Date.now(),(c=h-l)>24&&(l=h-c%24,g.debug.onTick&&console.log(p),f(),p++))}function v(){return{items:[],addItems:function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.items.find((function(e){return e.name===t}));n||(n={name:t,items:[]},this.items.push(n));for(var o=0,s=e;o<s.length;o++){var a=s[o];n.items.push(a)}},draw:function(t,e){this.items.forEach((function(i){i.items.forEach((function(i){i.sprite.draw(t,e,u)}))}))},empty:function(){this.items=[]},getItem:function(t){for(var e,i=0,n=this.items;i<n.length;i++){for(var o=0,s=n[i].items;o<s.length;o++){var a=s[o];if(a.name===t){e=a.sprite;break}}if(e)break}return e},getGroup:function(t){return this.items.find((function(e){return e.name===t}))},removeGroup:function(t){for(var e=0;e<this.items.length;e++)if(this.items[e].name===t){this.items.splice(e,1);break}},removeItem:function(t,e){for(var i=0,n=this.items;i<n.length;i++){var o=n[i];if(o.name===t){for(var s=0;s<o.items.length;s++)if(o.items[s].name===e){o.items.splice(s,1);break}break}}}}}function y(t,e){var i=Object.keys(t).length,n={},o=0;i||e({});var s=function(s){var a=new XMLHttpRequest;a.onload=function(){if(!(a.status>=200&&a.status<300))throw console.error(a.responseText),new Error('Tile "'+s+'" was not found');n[s]=JSON.parse(a.responseText),++o===i&&e(n)},a.open("GET",t[s]),a.send()};for(var a in t)s(a)}function w(t,e){var i={};for(var n in t){var o=t[n];o.endsWith(e)&&(i[n]=o)}return i}function b(t,e,i){function n(t){i(t)}t.load(w(e,".mp3"),(function(){y(w(e,".json"),n)}))}var x,P={tracks:{},load:function(t,e){var i=Object.keys(t).length,n=0;function o(){++n===i&&e()}for(var s in i||e(),t){var a=new Audio;this.tracks[s]=a,a.src=t[s],a.oncanplaythrough=o}},play:function(t,e,i){var n=this;void 0===e&&(e=!1),i&&(this.tracks[t].onended=function(){i(),n.tracks[t].onended=null}),this.tracks[t].loop=e,this.tracks[t].play()},pause:function(t){this.tracks[t].pause()},pauseAll:function(){for(var t in this.tracks)this.tracks[t].pause()}},k=function(){return(k=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},A=function(t,e){for(var i=0,n=e.length,o=t.length;i<n;i++,o++)t[o]=e[i];return t},S={},T=!1,I={count:0,ticks:0,callback:function(){},init:function(t,e){this.count=0,this.ticks=t,this.callback=e},update:function(){this.count++,this.count===this.ticks&&this.callback()}};function X(t){t.canvas.clear("static",t.bgColor),t.staticPool.draw("static",t.canvas)}function R(t){t.canvas.clear("dynamic"),t.dynamicPool.draw("dynamic",t.canvas)}function Y(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];x.data=t,x.init.apply(x,e),X(x),x.redrawStaticItems=function(){return X(x)},x.canvas.onResize=function(){"function"==typeof x.onResize&&x.onResize(),X(x)},T=!1}function E(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!S[t])throw new Error('scene "'+t+'" does not exist');T=!0,x&&(x.data={},x.other={},x.staticPool.empty(),x.dynamicPool.empty(),x.controls.reset(),"function"==typeof x.destroy&&x.destroy()),(x=S[t]).changeScene=E,x.preload&&Object.keys(x.preload).length?(x.config.debug&&console.log("waiting for "+t+" preload..."),b(x.mediaPlayer,x.preload,(function(i){Y.apply(void 0,A([i],e)),x.config.debug&&console.log("loaded scene: "+t)}))):(Y.apply(void 0,A([{}],e)),x.config.debug&&console.log("loaded scene: "+t))}var O=function(){return(O=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function j(t){return void 0===t&&(t={}),O({x:0,y:0,width:0,height:0,centerX:function(t){var e=t.x+t.width/2;this.x=Math.floor(e-this.width/2)},centerY:function(t){var e=t.y+t.height/2;this.y=Math.floor(e-this.height/2)},getBottom:function(){return this.y+this.height},getRight:function(){return this.x+this.width},getCenterX:function(){return this.x+this.width/2},getCenterY:function(){return this.y+this.height/2}},t)}var C=function(){return(C=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function W(t){return void 0===t&&(t={}),C({color:"#065",rectangle:t.rectangle,offsetX:0,offsetY:0,block:function(t){var e=this.getOverlap(t);Math.abs(e.x)<Math.abs(e.y)?t.rectangle.x-=e.x:t.rectangle.y-=e.y},draw:function(t,e){var i=e.config.ppp;e.context[t].globalAlpha=.4,e.context[t].fillStyle=this.color,e.context[t].fillRect(this.getX()*i,this.getY()*i,this.getWidth()*i,this.getHeight()*i)},getOverlap:function(t){if(!this.hasOverlap(t))return{x:0,y:0};var e=Math.max(this.getX(),t.getX()),i=Math.max(this.getY(),t.getY()),n=Math.min(this.getX()+this.getWidth(),t.getX()+t.getWidth())-e,o=Math.min(this.getY()+this.getHeight(),t.getY()+t.getHeight())-i;return{x:this.getX()<t.getX()?-n:n,y:this.getY()<t.getY()?-o:o}},getX:function(){return this.rectangle.x+this.offsetX},getY:function(){return this.rectangle.y+this.offsetY},getWidth:function(){return this.rectangle.width-2*this.offsetX},getHeight:function(){return this.rectangle.height-2*this.offsetY},getBottom:function(){return this.getY()+this.getHeight()},getRight:function(){return this.getX()+this.getWidth()},hasOverlap:function(t){return this.getX()<t.getRight()&&this.rectangle.getRight()>t.getX()&&this.getY()<t.getBottom()&&this.rectangle.getBottom()>t.getY()}},t)}var N=function(){return(N=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function D(t,e,i,n,o){var s=0,a=0,r=e.config.ppp,l=o.tiles[o.frame];e.context[t].globalAlpha=1;for(var c=0;c<l.length;c++){var h=l[c];h&&(e.context[t].fillStyle=h,e.context[t].fillRect((i+s)*r,(n+a)*r,r,r)),s===o.width-1?(s=0,a++):s++}}function H(t){void 0===t&&(t={});var e=void 0===t.isInteractive||t.isInteractive,i=j({width:t.metaTile.width,height:t.metaTile.height}),n=e?W({rectangle:i}):null;var o={};return N({hitBox:n,metaTile:null,playingAnimation:null,rectangle:i,visible:!0,draw:function(t,i,s){this.visible&&(!function(t,i,o){o.debug.hitBox&&e&&n.draw(t,i)}(t,i,s),s.debug.onTick&&console.log("MetaTileSprite.draw()"+(this.playingAnimation?" animation("+this.playingAnimation+")":"")),this.playingAnimation?o[this.playingAnimation].draw(t,i):D(t,i,this.rectangle.x,this.rectangle.y,this.metaTile))},addAnimation:function(t,e,i,n,s){var a=this,r=!0,l=!1,c=e,h=0;o[t]={start:function(){r=!0},stop:function(t){t&&(c=t>0?t:i),r=!1},draw:function(t,o){h<n?h++:(r&&(c=Math.min(i,++c)),l&&("loop"===s?c=e:"function"==typeof s&&s(),l=!1),h=0),r&&c===i&&(l=!0),a.metaTile.frame=c,D(t,o,a.rectangle.x,a.rectangle.y,a.metaTile)}}},startAnimation:function(t){this.stopAnimation(),o[t].start(),this.playingAnimation=t},stopAnimation:function(){this.playingAnimation&&(o[this.playingAnimation].stop(),this.playingAnimation=null)}},t)}var B=function(){return(B=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function M(t,e){if(t[e])return!0;throw new Error('Font does not contain the character "'+e+'"')}function L(t,e,i,n,o){for(var s=0,a=0,r=e.config.ppp,l=0;l<o.tile.length;l++)1===o.tile[l]&&e.context[t].fillRect((i+s+o.offsetX)*r,(n+a+o.offsetY)*r,r,r),s===o.width-1?(s=0,a++):s++}function F(t,e,i,n,o,s){for(var a=o.split(""),r=i,l=n,c=0;c<a.length;c++){var h=a[c];M(s.font,h)&&(L(t,e,r,l,s.font[h]),r+=s.font[h].width),r+=s.tracking}}function G(t,e,i){for(var n=[],o=t.split(" "),s=e.font[" "],a=s.width+s.offsetX+e.tracking,r="",l=0,c=0;c<o.length;c++){for(var h=o[c],f=0,g=0,u=h.split("");g<u.length;g++){var d=u[g];if(M(e.font,d)){var p=e.font[d];f+=p.width+p.offsetX+e.tracking}}(l+=f+=a)<=i?r+=h+" ":(""!==r&&n.push(r),r=h+" ",l=f)}return n.push(r.trimEnd()),n}function z(t){void 0===t&&(t={});var e=j({width:t.maxWidth||function(t,e){for(var i=0,n=0,o=t.split("");n<o.length;n++){var s=o[n];if(M(e.font,s)){var a=e.font[s];i+=a.width+a.offsetX+e.tracking}}return i}(t.value,t.options)}),i={};return B({color:"#c59",maxWidth:null,options:{font:null,tracking:0,lineHeight:0},playingAnimation:null,rectangle:e,value:"",visible:!0,draw:function(t,e,n){if(this.visible)if(e.context[t].fillStyle=this.color,n.debug.onTick&&console.log("TextSprite.draw()"+(this.playingAnimation?" animation("+this.playingAnimation+")":"")),this.playingAnimation)i[this.playingAnimation].draw(t,e);else if(this.maxWidth)for(var o=G(this.value,this.options,this.maxWidth),s=this.rectangle.y,a=0,r=o;a<r.length;a++){var l=r[a];F(t,e,this.rectangle.x,s,l,this.options),s+=this.options.lineHeight}else F(t,e,this.rectangle.x,this.rectangle.y,this.value,this.options)},addAnimation:function(t,e,n,o,s){var a=this,r=a.value.split("").length,l=0,c=e,h=!1,f=!0;n=n>0?n:r,i[t]={start:function(){f=!0},stop:function(t){t&&(c=t>0?t:r),f=!1},draw:function(t,i){if(a.visible)if(l<o?l++:(f&&(c=Math.min(n,++c)),h&&("loop"===s?c=e:"function"==typeof s&&s(),h=!1),l=0),f&&c===n&&(h=!0),a.maxWidth)for(var r=G(a.value,a.options,a.maxWidth),g=a.rectangle.y,u=0,d=0,p=r;d<p.length;d++){var m=p[d];if(!(u+m.length<c)){F(t,i,a.rectangle.x,g,m.slice(0,c-u),a.options),u+=c-u;break}F(t,i,a.rectangle.x,g,m,a.options),u+=m.length,g+=a.options.lineHeight}else F(t,i,a.rectangle.x,a.rectangle.y,a.value.slice(0,c),a.options)}}},startAnimation:function(t){this.stopAnimation(),i[t].start(),this.playingAnimation=t},stopAnimation:function(){this.playingAnimation&&(i[this.playingAnimation].stop(),this.playingAnimation=null)}},t)}var U={font:i(0),tracking:1,lineHeight:10},K={offsetX:7,offsetY:1,ticksPerBlink:16,tickCount:0,update:function(t,e){var i=t.dynamicPool.getItem("cursor");this.tickCount<this.ticksPerBlink?this.tickCount++:(i.visible=!i.visible,this.tickCount=0),i.rectangle.x=e.x-i.rectangle.width-this.offsetX,i.rectangle.y=e.y-this.offsetY}};function J(t){var e=t.config.titleSafe,i=j({width:t.canvas.config.width,height:t.canvas.config.height}),n=t.staticPool.getItem("title"),o=t.staticPool.getItem("about"),s=t.staticPool.getItem("about2"),a=t.staticPool.getItem("link"),r=t.staticPool.getItem("back");n.rectangle.centerX(i),n.rectangle.y=e,o.rectangle.x=e,o.rectangle.y=n.rectangle.y+2*U.lineHeight,s.rectangle.x=e,s.rectangle.y=o.rectangle.y+6*U.lineHeight,r.rectangle.centerX(i),r.rectangle.y=i.height-U.lineHeight-e,a.rectangle.centerX(i),a.rectangle.y=r.rectangle.y-2*U.lineHeight}var V,_={index:0},q={name:"about",bgColor:"#000",preload:{cursor:"src/scenes/assets/title/cursor.json"},init:function(){var t=this;_.index=0,K.tickCount=0,this.staticPool.addItems("main",{name:"title",sprite:z({color:"#eee",options:U,value:"ABOUT"})}),this.staticPool.addItems("main",{name:"about",sprite:z({color:"#eee",options:U,maxWidth:this.canvas.config.width-2*this.config.titleSafe,value:"THIS PROJECT IS AN ODE TO ONE OF MY FAVORITE PODCASTS: HELLO FROM THE MAGIC TAVERN. IT IS NOT AFFILIATED WITH THE SHOW IN ANY WAY. (NOT THAT I'M AGAINST THAT HAPPENING - JUST SAYING)"})}),this.staticPool.addItems("main",{name:"about2",sprite:z({color:"#eee",options:U,maxWidth:this.canvas.config.width-2*this.config.titleSafe,value:"I TAKE NO CREDIT FOR WHAT THE BRILLIANT, TWISTED MINDS OF THE ARTISTS HAVE CREATED; I AM MERELY EXPRESSING MY AFFECTION FOR SAID CREATION WITH A BIT OF 8BIT, JRPG-ESQUE FAN FIC."})}),this.staticPool.addItems("selection",{name:"link",sprite:z({color:"#eee",options:U,value:"SEE MORE..."})}),this.staticPool.addItems("selection",{name:"back",sprite:z({color:"#eee",options:U,value:"BACK TO TITLE SCREEN"})}),J(this),this.dynamicPool.addItems("main",{name:"cursor",sprite:H({metaTile:this.data.cursor})});var e=function(){switch(_.index){case 0:window.open("https://github.com/adventuresinfoon/adventuresinfoon.github.io/blob/main/README.md");break;case 1:t.changeScene("title")}},i=this.staticPool.getGroup("selection");this.controls.upPress=function(){_.index>0&&_.index--},this.controls.downPress=function(){_.index<i.items.length-1&&_.index++},this.controls.aPress=function(){e()},this.controls.startPress=function(){e()}},update:function(){var t=this.staticPool.getGroup("selection");K.update(this,t.items[_.index].sprite.rectangle)},onResize:function(){J(this)}};!function(t){t.South="South",t.West="West",t.North="North",t.East="East"}(V||(V={}));var Z=function(){return(Z=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function Q(t,e,i){var n=0,o=0;t.tiles.forEach((function(s,a){if(s>0){var r=t.legend[s],l=H(Z({metaTile:e.data[r.dataKey]},r.params));l.rectangle.x=n*t.tileSize,l.rectangle.y=o*t.tileSize,i.addItems(t.name,{name:r.name||""+t.name+a,sprite:l})}n===t.width-1?(n=0,o++):n++}))}function $(t,e){var i=0,n=0;e.other.walls=[],t.tiles.forEach((function(o){var s,a;o>0&&e.other.walls.push((s={x:i*t.tileSize,y:n*t.tileSize,width:t.tileSize,height:t.tileSize},{rectangle:a=j(s),hitBox:W({color:"#505",rectangle:a})})),i===t.width-1?(i=0,n++):i++}))}var tt={name:"forestIntro",bgColor:"#840",preload:{arnie:"src/scenes/assets/prologue/arnie.json",camry:"src/scenes/assets/prologue/camry.json",portalSmall:"src/scenes/assets/prologue/portal-small.json",brush:"src/scenes/assets/prologue/forest-intro/brush.json",brushS:"src/scenes/assets/prologue/forest-intro/brush-S.json",brushW:"src/scenes/assets/prologue/forest-intro/brush-W.json",brushN:"src/scenes/assets/prologue/forest-intro/brush-N.json",brushE:"src/scenes/assets/prologue/forest-intro/brush-E.json",brushSW:"src/scenes/assets/prologue/forest-intro/brush-SW.json",brushNW:"src/scenes/assets/prologue/forest-intro/brush-NW.json",brushNE:"src/scenes/assets/prologue/forest-intro/brush-NE.json",brushSE:"src/scenes/assets/prologue/forest-intro/brush-SE.json",dialogue:"src/scenes/assets/prologue/forest-intro/dialogue.json",dirt:"src/scenes/assets/prologue/forest-intro/dirt.json",grid:"src/scenes/assets/prologue/forest-intro/grid.json",tree:"src/scenes/assets/prologue/forest-intro/tree.json"},init:function(t){var e,i,n=this;e=this.data.grid,i=this,e.dynamicLayers.forEach((function(t){Q(t,i,i.dynamicPool)})),e.staticLayers.forEach((function(t){Q(t,i,i.staticPool)})),$(e.wallLayer,i);var o={x:192,y:112,facingDirection:V.South};t=t||o,this.other.arnie=function(t){var e,i,n=H({metaTile:t.data.arnie});t.dynamicPool.addItems("characters",{name:"arnie",sprite:n});var o=((e={})[V.South]=0,e[V.West]=4,e[V.North]=8,e[V.East]=12,e),s=((i={})[V.South]=!1,i[V.West]=!1,i[V.North]=!1,i[V.East]=!1,i);return n.addAnimation("walk:South",0,3,6,"loop"),n.addAnimation("walk:West",4,7,6,"loop"),n.addAnimation("walk:North",8,11,6,"loop"),n.addAnimation("walk:East",12,15,6,"loop"),n.hitBox.offsetX=2,n.hitBox.offsetY=2,{sprite:n,isWalking:!1,handleDirectionalPress:function(t){s[t]=!0,this.isWalking=!0,n.stopAnimation(),n.startAnimation("walk:"+t)},handleDirectionalRelease:function(t){s[t]=!1,n.stopAnimation(),s[V.South]&&n.startAnimation("walk:"+V.South),s[V.West]&&n.startAnimation("walk:"+V.West),s[V.North]&&n.startAnimation("walk:"+V.North),s[V.East]&&n.startAnimation("walk:"+V.East),s[V.South]||s[V.West]||s[V.North]||s[V.East]||(this.isWalking=!1,n.stopAnimation(),n.metaTile.frame=o[t])},setFacingDirection:function(t){n.metaTile.frame=o[t]},update:function(){this.isWalking&&(s[V.South]&&(n.rectangle.y+=1),s[V.West]&&(n.rectangle.x-=1),s[V.North]&&(n.rectangle.y-=1),s[V.East]&&(n.rectangle.x+=1))}}}(this),this.other.arnie.sprite.rectangle.x=t.x,this.other.arnie.sprite.rectangle.y=t.y,this.other.arnie.setFacingDirection(t.facingDirection),this.controls.downPress=function(){n.other.arnie.handleDirectionalPress(V.South)},this.controls.leftPress=function(){n.other.arnie.handleDirectionalPress(V.West)},this.controls.upPress=function(){n.other.arnie.handleDirectionalPress(V.North)},this.controls.rightPress=function(){n.other.arnie.handleDirectionalPress(V.East)},this.controls.downRelease=function(){n.other.arnie.handleDirectionalRelease(V.South)},this.controls.leftRelease=function(){n.other.arnie.handleDirectionalRelease(V.West)},this.controls.upRelease=function(){n.other.arnie.handleDirectionalRelease(V.North)},this.controls.rightRelease=function(){n.other.arnie.handleDirectionalRelease(V.East)}},update:function(t){var e=this;this.other.arnie.update(t),this.other.walls.forEach((function(i){i.hitBox.block(e.other.arnie.sprite.hitBox),e.config.debug.walls&&i.hitBox.draw("dynamic",t)}))}},et=function(){return(et=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function it(t){return void 0===t&&(t={}),et({fill:null,opacity:1,rectangle:j(),strokeColor:null,strokeWidth:1,visible:!0,draw:function(t,e,i){this.visible&&(i.debug.onTick&&console.log("RectangleSprite.draw()"),function(t,e,i,n,o,s,a){var r=e.config.ppp,l=e.context[t],c=l.globalAlpha;l.globalAlpha=a,i&&(l.fillStyle=i,l.fillRect(s.x*r,s.y*r,s.width*r,s.height*r)),n&&(l.strokeStyle=n,l.lineWidth=o,l.strokeRect(s.x*r,s.y*r,s.width*r,s.height*r)),l.globalAlpha=c}(t,e,this.fill,this.strokeColor,this.strokeWidth,this.rectangle,this.opacity))}},t)}var nt=0;function ot(t,e,i){var n=!1;nt=0,function(t){var e=it({fill:"#000",rectangle:j({x:26,y:26,width:266,height:60})}),i=it({fill:"#eee",rectangle:j({x:26,y:24,width:266,height:2})}),n=it({fill:"#eee",rectangle:j({x:292,y:26,width:2,height:60})}),o=it({fill:"#eee",rectangle:j({x:26,y:86,width:266,height:2})}),s=it({fill:"#eee",rectangle:j({x:24,y:26,width:2,height:60})}),a=it({fill:"#eee",rectangle:j({x:25,y:25,width:2,height:2})}),r=it({fill:"#eee",rectangle:j({x:291,y:25,width:2,height:2})}),l=it({fill:"#eee",rectangle:j({x:291,y:85,width:2,height:2})}),c=it({fill:"#eee",rectangle:j({x:25,y:85,width:2,height:2})});t.dynamicPool.addItems("dialogue",{name:"bg",sprite:e},{name:"borderTop",sprite:i},{name:"borderRight",sprite:n},{name:"borderBottom",sprite:o},{name:"borderLeft",sprite:s},{name:"borderTopLeft",sprite:a},{name:"borderTopRight",sprite:r},{name:"borderBottomRight",sprite:l},{name:"borderBottomLeft",sprite:c})}(t);var o=z({color:"#eee",options:U,value:e[nt].name+":"}),s=z({color:"#eee",maxWidth:254,options:U,value:e[nt].dialogue});return o.rectangle.x=32,o.rectangle.y=32,s.rectangle.x=32,s.rectangle.y=32+U.lineHeight,s.addAnimation("advance",0,-1,t.config.textAdvanceSpeed,(function(){n=!0})),s.startAnimation("advance"),t.dynamicPool.addItems("dialogue",{name:"nameText",sprite:o},{name:"dialogueText",sprite:s}),{advance:function(){if(n){if(nt===e.length-1)return t.dynamicPool.removeGroup("dialogue"),void("function"==typeof i&&i());nt++,n=!1,o.value=e[nt].name+":",s.value=e[nt].dialogue,s.addAnimation("advance",0,-1,t.config.textAdvanceSpeed,(function(){n=!0})),s.startAnimation("advance")}else n=!0,s.stopAnimation()}}}function st(t,e,i){var n=j({width:e.canvas.config.width,height:e.canvas.config.height}),o="in"===t?1:0,s=it({fill:"#000",rectangle:n});e.dynamicPool.addItems("transitions",{name:"rect",sprite:s});var a=function(){o-="in"===t?.26:-.26,s.opacity=o,"in"===t&&o<.1||"out"===t&&o>1?(e.dynamicPool.removeGroup("transitions"),i()):e.delay(8,a)};e.delay(8,a)}var at={name:"intro",bgColor:"#000",preload:{bg:"src/scenes/assets/intro/viscous-space.json",dialogue:"src/scenes/assets/intro/dialogue.json",static:"src/scenes/assets/intro/static.mp3",beepBoop:"src/scenes/assets/intro/beep-boop.mp3"},init:function(){var t=this;this.mediaPlayer.play("static",!1,(function(){t.mediaPlayer.play("beepBoop",!0),t.staticPool.addItems("bg",{name:"bg",sprite:H({metaTile:t.data.bg})}),t.redrawStaticItems(),st("in",t,(function(){var e=ot(t,t.data.dialogue,(function(){t.mediaPlayer.pauseAll(),t.changeScene("parkingLotIntro")}));t.controls.aPress=function(){e.advance()}}))})),this.onResize=function(){return(e=t.staticPool.getItem("bg")).rectangle.x=0,void(e.rectangle.y=0);var e}}},rt={name:"loading",bgColor:"#000",init:function(){var t=z({color:"#eee",options:U,value:"LOADING"});this.staticPool.addItems("main",{name:"main",sprite:t});var e=z({color:"#eee",options:U,value:"..."});e.addAnimation("cycle",0,null,16,"loop"),e.startAnimation("cycle"),this.dynamicPool.addItems("main",{name:"ellipsis",sprite:e});var i=this.canvas.config.height-(t.rectangle.height+16);t.rectangle.x=this.canvas.config.width-(t.rectangle.width+e.rectangle.width+8),t.rectangle.y=i,e.rectangle.x=t.rectangle.x+t.rectangle.width,e.rectangle.y=i}};var lt,ct,ht={portalShown:!1,portalSpedUp:!1,portalSuckingInCar:!1,portalConsumedCar:!1},ft={name:"parkingLotIntro",bgColor:"#444",preload:{camry:"src/scenes/assets/prologue/camry.json",dialogue:"src/scenes/assets/prologue/parking-lot-intro/dialogue.json",portalLarge:"src/scenes/assets/prologue/portal-large.json",portalSmall:"src/scenes/assets/prologue/portal-small.json",parkingLot:"src/scenes/assets/prologue/parking-lot-intro/parking-lot.json"},init:function(){var t=this;this.staticPool.addItems("main",{name:"smallPortal",sprite:H({metaTile:this.data.parkingLot})});var e=j({width:this.canvas.config.width,height:this.canvas.config.height}),i=H({metaTile:this.data.camry}),n=H({metaTile:this.data.portalSmall}),o=H({metaTile:this.data.portalLarge});ct=[this.data.dialogue.slice(0,3),this.data.dialogue.slice(3,4),this.data.dialogue.slice(4,5)],i.rectangle.centerX(e),i.rectangle.x-=40,i.rectangle.y=e.height/2-4,o.visible=!1,n.visible=!1,this.dynamicPool.addItems("main",{name:"smallPortal",sprite:n},{name:"largePortal",sprite:o},{name:"camry",sprite:i}),st("in",this,(function(){lt=ot(t,ct[0],(function(){ht.portalShown||(ht.portalShown=!0,function(t,e,i,n){t.visible=!0,t.rectangle.x=i.canvas.config.width/2+32,t.rectangle.y=i.canvas.config.height/2+8,t.addAnimation("pulse",0,3,4,(function(){e.visible=!0,t.visible=!1,e.rectangle.x=i.canvas.config.width/2+24,e.rectangle.y=i.canvas.config.height/2,e.addAnimation("pulse",0,3,4,"loop"),e.startAnimation("pulse"),i.delay(24,n)})),t.startAnimation("pulse")}(n,o,t,(function(){lt=ot(t,ct[1],(function(){ht.portalSpedUp||(ht.portalSpedUp=!0,function(t){t.stopAnimation(),t.addAnimation("pulse",0,3,2,"loop"),t.startAnimation("pulse")}(o),t.delay(24,(function(){ht.portalSuckingInCar=!0})))}))})))})),t.controls.aPress=function(){lt.advance()}}))},update:function(){var t=this;if(ht.portalSuckingInCar){var e=this.dynamicPool.getItem("camry");if(e.rectangle.x+=1,e.rectangle.x>156){ht.portalSuckingInCar=!1,ht.portalConsumedCar=!0;var i=it({fill:"#eee"});i.rectangle.width=this.canvas.config.width,i.rectangle.height=this.canvas.config.height,this.dynamicPool.addItems("main",{name:"flash",sprite:i}),lt=ot(this,ct[2],(function(){t.changeScene("forestIntro")}))}}}};function gt(t){var e=j({width:t.canvas.config.width,height:t.canvas.config.height}),i=t.staticPool.getItem("controls"),n=t.dynamicPool.getItem("anyKey");i.rectangle.centerX(e),i.rectangle.y=18,n.rectangle.centerX(e),n.rectangle.y=e.height-2*U.lineHeight-t.config.titleSafe}var ut={ticksPerBlink:16,tickCount:0,update:function(t){var e=t.dynamicPool.getItem("anyKey");this.tickCount<this.ticksPerBlink?this.tickCount++:(e.visible=!e.visible,this.tickCount=0)}},dt={name:"splash",bgColor:"#000",preload:{controls:"src/scenes/assets/splash/controls.json"},init:function(){var t=this;ut.tickCount=0,this.controls.keyDown=function(){t.canvas.requestFullscreen(),t.changeScene("title")},this.staticPool.addItems("main",{name:"controls",sprite:H({metaTile:this.data.controls})}),this.dynamicPool.addItems("main",{name:"anyKey",sprite:z({color:"#eee",options:U,value:"PRESS ANY BUTTON TO CONTINUE"})}),gt(this)},update:function(){ut.update(this)},onResize:function(){gt(this)}};function pt(t){var e=j({width:t.canvas.config.width,height:t.canvas.config.height}),i=t.staticPool.getItem("titleText"),n=t.staticPool.getItem("startGame"),o=t.staticPool.getItem("about"),s=t.staticPool.getItem("copyright");i.rectangle.centerX(e),n.rectangle.centerX(e),o.rectangle.centerX(e),s.rectangle.centerX(e),i.rectangle.y=18,n.rectangle.y=154,o.rectangle.y=n.rectangle.y+2*U.lineHeight,s.rectangle.y=e.height-U.lineHeight-t.config.titleSafe}var mt={index:0},vt={name:"title",bgColor:"#000",preload:{theme:"src/scenes/assets/title/theme.mp3",select:"src/scenes/assets/title/select.mp3",titleText:"src/scenes/assets/title/title-text.json",cursor:"src/scenes/assets/title/cursor.json"},init:function(){var t=this;mt.index=0,K.tickCount=0,this.staticPool.addItems("main",{name:"titleText",sprite:H({metaTile:this.data.titleText})}),this.staticPool.addItems("main",{name:"copyright",sprite:z({color:"#eee",options:U,value:"2021 COSMIC POLYGON"})}),this.staticPool.addItems("selection",{name:"startGame",sprite:z({color:"#eee",options:U,value:"START GAME"})}),this.staticPool.addItems("selection",{name:"about",sprite:z({color:"#eee",options:U,value:"ABOUT"})}),pt(this),this.dynamicPool.addItems("main",{name:"cursor",sprite:H({metaTile:this.data.cursor})});var e=function(){switch(P.pauseAll(),P.play("select"),mt.index){case 0:t.changeScene("intro");break;case 1:t.changeScene("about")}},i=this.staticPool.getGroup("selection");this.controls.upPress=function(){mt.index>0&&mt.index--},this.controls.downPress=function(){mt.index<i.items.length-1&&mt.index++},this.controls.aPress=function(){e()},this.controls.startPress=function(){e()},P.play("theme",!0)},update:function(){var t=this.staticPool.getGroup("selection");K.update(this,t.items[mt.index].sprite.rectangle)},onResize:function(){pt(this)}},yt={debug:{allowFullscreen:!1,hitBox:!1,onTick:!1,preventDefault:!1,walls:!1,warnOnReload:!1},textAdvanceSpeed:2,titleSafe:12,isTouchscreen:"ontouchstart"in window},wt=function(t,e){void 0===e&&(e={});var i=n({ppp:1,width:320,height:240},e);function o(e){var n=document.createElement("canvas");n.id=e,n.width=i.width,n.height=i.height,n.style.position="absolute",t.debug.preventDefault&&n.addEventListener("contextmenu",(function(t){return t.preventDefault()}));var o=n.getContext("2d");return o.imageSmoothingEnabled=!1,{element:n,context:o}}var s=o("static"),a=o("dynamic");return document.body.style.margin="0",document.body.style.backgroundColor="#000",document.body.appendChild(s.element),document.body.appendChild(a.element),{element:{static:s.element,dynamic:a.element},context:{static:s.context,dynamic:a.context},config:i,onResize:null,clear:function(t,e){var i=this.config.width,n=this.config.height,o=this.config.ppp;e?(this.context[t].fillStyle=e,this.context[t].fillRect(0,0,i*o,n*o)):this.context[t].clearRect(0,0,i*o,n*o)},getScaleFactor:function(t,e){var i,n=t>e,o=this.config.width>this.config.height;return(i=n?o&&this.config.height*(t/this.config.width)<=e?t/this.config.width:e/this.config.height:!o&&this.config.width*(e/this.config.height)<=t?e/this.config.height:t/this.config.width)<2?i:Math.floor(i)},fitToViewport:function(){var t=window.innerWidth,e=window.innerHeight,i=this.getScaleFactor(t,e);for(var n in this.config.ppp=i,this.element){var o=this.element[n];o.width=this.config.width*i,o.height=this.config.height*i,o.style.top=e/2-o.height/2+"px",o.style.left=t/2-o.width/2+"px"}"function"==typeof this.onResize&&this.onResize()},requestFullscreen:function(){t.debug.allowFullscreen&&document.documentElement.requestFullscreen()}}}(yt);wt.fitToViewport(),window.onresize=function(){return wt.fitToViewport()},window.ondeviceorientation=function(){return wt.fitToViewport()},yt.debug.warnOnReload&&(window.onbeforeunload=function(){return!0}),u={config:yt}.config,function(t){o=t.config}({config:yt}),function(t,e,i,n){for(var o,s=[],a=4;a<arguments.length;a++)s[a-4]=arguments[a];for(var l in t){var c=t[l];c=k(k({},c),{canvas:i,config:n,controls:r,delay:I.init.bind(I),dynamicPool:v(),data:{},mediaPlayer:P,other:{},staticPool:v()}),S[l]=c}S.loading&&(o=S.loading).init.apply(o,s),E.apply(void 0,A([e],s))}({loading:rt,splash:dt,title:vt,about:q,intro:at,parkingLotIntro:ft,forestIntro:tt},"splash",wt,yt),function(t){g=t.config,f=t.cb,l=Date.now(),d=!0,m()}({cb:function(){var t;t=wt,T?(X(S.loading),R(S.loading)):(R(x),"function"==typeof x.update&&x.update(t),I.update(),x.controls.update())},config:yt})}]);